!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t((e=e||self).Iris={})}(this,(function(e){"use strict";const t={accountId:null,initted:!1,options:{cookiePrefix:"_iris_",targetUrl:"/",useBeacon:!0}},n=e=>null!=e&&""!==e,o=()=>"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,e=>{const t=16*Math.random()|0;return("x"===e?t:3&t|8).toString(16)}),i={getParameterByName(e,t){let n=t;t||(n=window.location.href),e=e.replace(/[\[\]]/g,"\\$&");const o=new RegExp(`[?&]${e}(=([^&#]*)|&|#|$)`,"i").exec(n);return o?o[2]?decodeURIComponent(o[2].replace(/\+/g," ")):"":null},externalHost:e=>e.hostname!==window.location.hostname&&0===e.protocol.indexOf("http")},r={set(e,n,o=1440,i="/"){const r=new Date;r.setTime(r.getTime()+60*o*1e3);const s="; expires="+r.toGMTString();document.cookie=`${t.options.cookiePrefix+e}=${n}${s}; path=${i}`},get(e){const n=t.options.cookiePrefix+e+"=",o=document.cookie.split(";");for(let e=0;e<o.length;e+=1){let t=o[e];for(;" "===t.charAt(0);)t=t.substring(1);if(0===t.indexOf(n))return t.substring(n.length,t.length)}return""},setUtms(){const e=["utm_source","utm_medium","utm_term","utm_content","utm_campaign"];let t=!1;for(let o=0,r=e.length;o<r;o+=1)if(n(i.getParameterByName(e[o]))){t=!0;break}if(t){let t;const o={};for(let r=0,s=e.length;r<s;r+=1)t=i.getParameterByName(e[r]),n(t)&&(o[e[r]]=t);r.set("utm",JSON.stringify(o))}}},s={nameAndVersion(){const e=navigator.userAgent;let t,n=e.match(/(opera|chrome|safari|firefox|msie|trident(?=\/))\/?\s*(\d+)/i)||[];return/trident/i.test(n[1])?(t=/\brv[ :]+(\d+)/g.exec(e)||[],"IE "+(t[1]||"")):"Chrome"===n[1]&&(t=e.match(/\b(OPR|Edge)\/(\d+)/),null!==t)?t.slice(1).join(" ").replace("OPR","Opera"):(n=n[2]?[n[1],n[2]]:[navigator.appName,navigator.appVersion,"-?"],t=e.match(/version\/(\d+)/i),null!==t&&n.splice(1,1,t[1]),n.join(" "))},isMobile:()=>"ontouchstart"in document,userAgent:()=>window.navigator.userAgent},a=()=>{let e=r.get("uid");return n(e)||(e=o()),r.set("uid",e,1051200),e},c=()=>{let e=r.get("sid");return n(e)||(e=o()),r.set("sid",e,30),e},d=(e,n)=>({id:t.accountId,uid:a(),sid:c(),ev:e,ed:n,dl:window.location.href,rl:document.referrer,ts:1*new Date,de:document.characterSet,sr:`${window.screen.width}x${window.screen.height}`,vp:`${window.innerWidth}x${window.innerHeight}`,cd:window.screen.colorDepth,dt:document.title,bn:s.nameAndVersion(),md:s.isMobile(),ua:s.userAgent(),tz:(new Date).getTimezoneOffset(),utm:r.get("utm")||""}),u=e=>n(e)?"object"==typeof e?JSON.stringify(e):"function"==typeof e?e(e()):String(e):"",l=e=>{let n="?";return Object.keys(e).forEach(t=>{n+=`${t}=${encodeURIComponent(e[t])}&`}),t.options.targetUrl+n},m=e=>{window.navigator.sendBeacon(l(e))},g=e=>{const t=document.createElement("img");t.src=l(e),t.style.display="none",t.width="1",t.height="1",document.getElementsByTagName("body")[0].appendChild(t)},x=(e,n)=>{if(!0!==t.initted)return;const o=d(e,u(n));window.navigator.sendBeacon&&t.options.useBeacon?m(o):g(o)},f=(e,o)=>{!0!==t.initted&&n(e)&&n(o)&&n(o.targetUrl)&&(t.accountId=e,t.options.targetUrl=o.targetUrl,n(o.cookiePrefix)&&(t.options.cookiePrefix=o.cookiePrefix),n(o.useBeacon)&&(t.options.useBeacon=o.useBeacon),c(),a(),r.setUtms(),t.initted=!0)},p={init:f,fire:x};e.default=p,e.ensureAndGetSessionID=c,e.ensureAndGetVisitorID=a,e.fire=x,e.getContent=d,e.getTargetUrl=l,e.init=f,e.marshalData=u,e.sendBeacon=m,e.sendImage=g,Object.defineProperty(e,"__esModule",{value:!0})}));
